---
format_version: "23"
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git
project_type: other
workflows:
  primary:
    steps:
      - git-clone@8:
          inputs:
            - clone_into_dir: "$BITRISE_SOURCE_DIR"
            - repository_url: "$GIT_REPOSITORY_URL"
      - get-identity-token@0:
          inputs:
            - audience: tuist
      - script@1:
          title: Exchange OIDC token
          inputs:
            - content: |
                curl -X POST https://staging.tuist.dev/api/auth/oidc/token \
                  -H "Content-Type: application/json" \
                  -d "{\"token\": \"$BITRISE_IDENTITY_TOKEN\"}"
meta:
  bitrise.io:
    stack: linux-docker-android-22.04
    machine_type_id: standard
