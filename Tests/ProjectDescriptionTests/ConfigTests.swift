import Foundation
import XCTest
import TuistSupportTesting
@testable import ProjectDescription

final class ConfigTests: XCTestCase {
    func test_config_toJSON() throws {
        let config = Config(
            cloud: Cloud(url: "https://cloud.tuist.io", projectId: "123", options: [.insights]),
            generationOptions: [
                .xcodeProjectName("someprefix-\(.projectName)"),
                .organizationName("TestOrg"),
                .developmentRegion("de"),
                .disableAutogeneratedSchemes,
                .disableSynthesizedResourceAccessors,
                .disableShowEnvironmentVarsInScriptPhases,
                .enableCodeCoverage,
                .fileHeaderTemplate("Template Header"),
            ]
        )

        XCTAssertCodable(config)
    }

    func test_config_toJSON_WITH_gitPlugin() {
        let config = Config(
            plugins: [.git(url: "https://git.com/repo.git", tag: "1.0.0")],
            generationOptions: []
        )

        XCTAssertCodable(config)
    }

    func test_config_toJSON_WITH_localPlugin() {
        let config = Config(
            plugins: [.local(path: "/some/path/to/plugin")],
            generationOptions: []
        )

        XCTAssertCodable(config)
    }

    func test_config_toJSON_withAutogeneratedSchemes() throws {
        let config = Config(
            cloud: Cloud(url: "https://cloud.tuist.io", projectId: "123", options: [.insights]),
            generationOptions: [
                .xcodeProjectName("someprefix-\(.projectName)"),
                .developmentRegion("de"),
                .organizationName("TestOrg"),
            ]
        )

        XCTAssertCodable(config)
    }
    
    func test_config_toJSON_fileHeaderTemplateFile() throws {
        let config = Config(
            cloud: Cloud(url: "https://cloud.tuist.io", projectId: "123", options: [.insights]),
            generationOptions: [
                .xcodeProjectName("someprefix-\(.projectName)"),
                .developmentRegion("de"),
                .organizationName("TestOrg"),
                .fileHeaderTemplate(.file("Path/To/Template")),
            ])
        
        XCTAssertCodable(config)
    }
}
