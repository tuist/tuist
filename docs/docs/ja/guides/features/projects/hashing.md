---
{
  "title": "Hashing",
  "titleTemplate": ":title · Projects · Features · Guides · Tuist",
  "description": "Learn about Tuist's hashing logic upon which features like binary caching and selective testing are built."
}
---
# ハッシング {#hashing}

1}キャッシュ</LocalizedLink>や選択的テスト実行のような機能には、ターゲットが変更されたかどうかを判断する方法が必要です。Tuistは依存関係グラフの各ターゲットについてハッシュを計算し、ターゲットが変更されたかどうかを判定する。ハッシュは以下の属性に基づいて計算される：

- ターゲットの属性（名前、プラットフォーム、製品など）
- ターゲットのファイル
- ターゲットの依存関係のハッシュ

### キャッシュ属性 {#cache-attributes}

さらに、<LocalizedLink href="/guides/features/cache">caching</LocalizedLink>のハッシュを計算するとき、以下の属性もハッシュする。

#### スウィフトバージョン {#swift-version}

`/usr/bin/xcrun swift --version`
というコマンドを実行して得られたSwiftバージョンをハッシュ化し、ターゲットとバイナリ間のSwiftバージョンの不一致によるコンパイルエラーを防ぐ。

> [注意] MODULE STABILITY 以前のバージョンのバイナリ・キャッシングでは、`BUILD_LIBRARY_FOR_DISTRIBUTION`
> ビルド設定を使用して
> [モジュールの安定性](https://www.swift.org/blog/library-evolution#enabling-library-evolution-support)
> を有効にし、どのコンパイラ・バージョンでもバイナリを使用できるようにしていました。しかし、モジュールの安定性をサポートしないターゲットを使用するプロジェクトでは、コンパイルの問題が発生しました。生成されたバイナリはそれらをコンパイルするために使用された
> Swift のバージョンにバインドされ、Swift のバージョンはプロジェクトをコンパイルするために使用されたものと一致しなければなりません。

#### コンフィギュレーション {#configuration}

`-configuration`
というフラグの背後にあるアイデアは、デバッグ・バイナリがリリース・ビルドで使用されないようにすることであり、その逆も同様である。しかし、他のコンフィギュレーションが使用されないようにプロジェクトから削除するメカニズムがまだ不足しています。

## デバッグ {#debugging}

環境や呼び出しにまたがってキャッシュを使用したときに非決定的な動作に気づいた場合、それは環境間の違いやハッシュロジックのバグに関連している可能性があります。この問題をデバッグするために以下のステップを踏むことをお勧めします：

1. 環境間で同じ[設定](#configuration)と[Swiftのバージョン](#swift-version)が使用されていることを確認してください。
2. `tuist generate` の2つの連続した呼び出しによって生成された Xcode
   プロジェクトの間に違いがあるかどうか、または環境を越えてチェックします。`diff`
   コマンドを使用して、プロジェクトを比較することができます。生成されたプロジェクトは、**絶対パス**
   を含み、ハッシュロジックが非決定的になる可能性があります。

> [注意] より良いデバッグ体験を計画中
> デバッグ体験の向上は我々のロードマップにある。print-hashesコマンドは、違いを理解するためのコンテキストを欠いているため、ハッシュ間の違いを表示するためにツリーのような構造を使用する、よりユーザーフレンドリーなコマンドに置き換えられる予定です。
