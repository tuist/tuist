---
{
  "title": "Module cache",
  "titleTemplate": ":title · Cache · Features · Guides · Tuist",
  "description": "Optimize your build times by caching compiled binaries and sharing them across different environments."
}
---

# ذاكرة التخزين المؤقت للوحدة النمطية {#وحدة-ذاكرة التخزين المؤقت}

:::: متطلبات التحذير
<!-- -->
- مشروع <LocalizedLink href="/guides/features/projects">تم
  إنشاؤه</LocalizedLink>
- حساب <LocalizedLink href="/guides/server/accounts-and-projects">Tuist
  والمشروع</LocalizedLink>
<!-- -->
:::

توفر ذاكرة التخزين المؤقتة لوحدة Tuist طريقة فعالة لتحسين أوقات الإنشاء عن طريق
تخزين وحداتك مؤقتًا كملفات ثنائية (`.xcframework`s) ومشاركتها عبر بيئات مختلفة.
تتيح لك هذه الإمكانية الاستفادة من الملفات الثنائية التي تم إنشاؤها مسبقًا، مما
يقلل من الحاجة إلى التجميع المتكرر ويسرع عملية التطوير.

## التحذير {#warming}

يستخدم Tuist بشكل فعال
<LocalizedLink href="/guides/features/projects/hashing">العلامات
المربعة</LocalizedLink> لكل هدف في مخطط التبعية للكشف عن التغييرات. باستخدام هذه
البيانات، يقوم ببناء وتعيين معرفات فريدة للملفات الثنائية المشتقة من هذه
الأهداف. في وقت إنشاء المخطط، يقوم Tuist بعد ذلك باستبدال الأهداف الأصلية بسلاسة
بالإصدارات الثنائية المقابلة لها.

تنتج هذه العملية، المعروفة باسم "تسخين" *"warming"،* ثنائيات للاستخدام المحلي أو
للمشاركة مع زملاء الفريق وبيئات CI عبر Tuist. عملية تسخين ذاكرة التخزين المؤقتة
بسيطة ويمكن بدؤها بأمر بسيط:


```bash
tuist cache
```

يعيد الأمر استخدام الملفات الثنائية لتسريع العملية.

## الاستخدام {#استخدام}

بشكل افتراضي، عندما تتطلب أوامر Tuist إنشاء مشروع، فإنها تستبدل التبعيات
تلقائيًا بمكافئاتها الثنائية من ذاكرة التخزين المؤقت، إذا كانت متوفرة. بالإضافة
إلى ذلك، إذا حددت قائمة بالأهداف التي تريد التركيز عليها، فسيقوم Tuist أيضًا
باستبدال أي أهداف تابعة بثنائياتها المخزنة في ذاكرة التخزين المؤقت، بشرط أن تكون
متوفرة. بالنسبة لأولئك الذين يفضلون نهجًا مختلفًا، هناك خيار لإلغاء هذا السلوك
تمامًا باستخدام علامة محددة:

:::: مجموعة الرموز
```bash [Project generation]
tuist generate # Only dependencies
tuist generate Search # Dependencies + Search dependencies
tuist generate Search Settings # Dependencies, and Search and Settings dependencies
tuist generate --cache-profile none # No cache at all
```

```bash [Testing]
tuist test
```
<!-- -->
:::

:::: تحذير
<!-- -->
التخزين المؤقت الثنائي هو ميزة مصممة لعمليات سير العمل التطويرية مثل تشغيل
التطبيق على جهاز محاكاة أو جهاز، أو إجراء الاختبارات. وهي غير مخصصة لإصدارات
الإصدار. عند أرشفة التطبيق، قم بإنشاء مشروع مع المصادر باستخدام `--cache-profile
none`.
<!-- -->
:::

## ملفات تعريف ذاكرة التخزين المؤقت {#cache-profiles}

يدعم Tuist ملفات تعريف ذاكرة التخزين المؤقت للتحكم في مدى قوة استبدال الأهداف
بملفات ثنائية مخزنة في ذاكرة التخزين المؤقت عند إنشاء المشاريع.

- المدمجة:
  - `only-external`: استبدل التبعيات الخارجية فقط (إعداد النظام الافتراضي)
  - `all-possible`: استبدل أكبر عدد ممكن من الأهداف (بما في ذلك الأهداف
    الداخلية)
  - `none`: لا تستبدل أبدًا بالثنائيات المخزنة مؤقتًا

حدد ملف تعريف باستخدام `--cache-profile` على `tuist generate`:

```bash
# Built-in profiles
tuist generate --cache-profile all-possible

# Custom profiles (defined in Tuist Config)
tuist generate --cache-profile development

# Use config default (no flag)
tuist generate

# Focus on specific targets (implies all-possible)
tuist generate MyModule AnotherTarget

# Disable binary replacement entirely
tuist generate --cache-profile none
```

::: info DEPRECATED FLAG
<!-- -->
تم إهمال علامة `--no-binary-cache`. استخدم `--cache-profile none` بدلاً من ذلك.
لا تزال العلامة المهملة تعمل من أجل التوافق مع الإصدارات السابقة.
<!-- -->
:::

الأولوية عند تحديد السلوك الفعال (من الأعلى إلى الأدنى):

1. `--cache-profile none`
2. تركيز الهدف (تمرير الأهداف إلى `إنشاء`) → ملف تعريف `كل الاحتمالات`
3. `--cache-profile &lt;قيمة&gt;`
4. الإعداد الافتراضي (إذا تم تعيينه)
5. إعدادات النظام الافتراضية (`only-external`)

## المنتجات المدعومة {#supported-products}

يمكن لـ Tuist تخزين المنتجات المستهدفة التالية فقط في ذاكرة التخزين المؤقت:

- الأطر (الثابتة والديناميكية) التي لا تعتمد على
  [XCTest](https://developer.apple.com/documentation/xctest)
- الحزم
- ماكرو سويفت

نحن نعمل على دعم المكتبات والأهداف التي تعتمد على XCTest.

::: info UPSTREAM DEPENDENCIES
<!-- -->
عندما يكون الهدف غير قابل للتخزين المؤقت، فإن ذلك يجعل الأهداف الأولية غير قابلة
للتخزين المؤقت أيضًا. على سبيل المثال، إذا كان لديك مخطط التبعية `A &gt; B` ،
حيث يعتمد A على B، فإن B غير قابل للتخزين المؤقت، فإن A سيكون أيضًا غير قابل
للتخزين المؤقت.
<!-- -->
:::

## الكفاءة {#efficiency}

يعتمد مستوى الكفاءة الذي يمكن تحقيقه باستخدام التخزين المؤقت الثنائي بشكل كبير
على بنية الرسم البياني. لتحقيق أفضل النتائج، نوصي بما يلي:

1. تجنب الرسوم البيانية التابعة المتداخلة للغاية. كلما كان الرسم البياني أقل
   تعقيدًا، كان ذلك أفضل.
2. حدد التبعيات باستخدام أهداف البروتوكول/الواجهة بدلاً من أهداف التنفيذ، وقم
   بتنفيذ التبعيات من الأهداف الأعلى.
3. قسّم الأهداف التي يتم تعديلها بشكل متكرر إلى أهداف أصغر حجمًا تكون احتمالية
   تغييرها أقل.

الاقتراحات المذكورة أعلاه هي جزء من
<LocalizedLink href="/guides/features/projects/tma-architecture">البنية
المعيارية</LocalizedLink>، التي نقترحها كطريقة لتنظيم مشاريعك لتحقيق أقصى
استفادة ليس فقط من التخزين المؤقت الثنائي ولكن أيضًا من إمكانات Xcode.

## الإعداد الموصى به {#recommended-setup}

نوصي بإنشاء مهمة CI تعمل **في كل عملية التزام في الفرع الرئيسي** لتسخين ذاكرة
التخزين المؤقت. سيضمن ذلك أن تحتوي ذاكرة التخزين المؤقت دائمًا على ثنائيات
للتغييرات في `main` بحيث يتم إنشاء الفرع المحلي وفرع CI بشكل تدريجي بناءً عليها.

::: tip CACHE WARMING USES BINARIES
<!-- -->
يستخدم الأمر `tuist cache` أيضًا ذاكرة التخزين المؤقتة الثنائية لتسريع عملية
التسخين.
<!-- -->
:::

فيما يلي بعض الأمثلة على سير العمل الشائع:

### يبدأ المطور العمل على ميزة جديدة {#a-developer-starts-to-work-on-a-new-feature}

1. يقومون بإنشاء فرع جديد من `main`.
2. يتم تشغيل `tuist لتوليد`.
3. يقوم Tuist بسحب أحدث الملفات الثنائية من `main` ويقوم بإنشاء المشروع
   باستخدامها.

### يقوم المطور بدفع التغييرات إلى المنبع {#a-developer-pushes-changes-upstream}

1. سيتم تشغيل خط أنابيب CI `xcodebuild build` أو `tuist test` لإنشاء المشروع أو
   اختباره.
2. سيقوم سير العمل بسحب أحدث الملفات الثنائية من `main` وإنشاء المشروع
   باستخدامها.
3. ثم سيقوم ببناء أو اختبار المشروع بشكل تدريجي.

## التكوين {#التكوين}

### حد التزامن للذاكرة المؤقتة {#cache-concurrency-limit}

بشكل افتراضي، يقوم Tuist بتنزيل وتحميل عناصر التخزين المؤقت دون أي حد للتزامن،
مما يزيد من الإنتاجية إلى أقصى حد. يمكنك التحكم في هذا السلوك باستخدام متغير
بيئة `TUIST_CACHE_CONCURRENCY_LIMIT`:

```bash
# Set a specific concurrency limit
export TUIST_CACHE_CONCURRENCY_LIMIT=10
tuist generate

# Use "none" for no limit (default behavior)
export TUIST_CACHE_CONCURRENCY_LIMIT=none
tuist generate
```

قد يكون هذا مفيدًا في البيئات ذات النطاق الترددي المحدود للشبكة أو لتقليل حمل
النظام أثناء عمليات التخزين المؤقت.

## استكشاف الأخطاء وإصلاحها {#استكشاف الأخطاء وإصلاحها}

### لا يستخدم ثنائيات لجهاتي المستهدفة {#it-doesnt-use-binaries-for-my-targets}

تأكد من أن علامات التجزئة
<LocalizedLink href="/guides/features/projects/hashing#debugging"> حتمية
</LocalizedLink> عبر البيئات وعمليات التشغيل. قد يحدث هذا إذا كان المشروع يحتوي
على مراجع للبيئة، على سبيل المثال من خلال المسارات المطلقة. يمكنك استخدام الأمر
`diff` لمقارنة المشاريع التي تم إنشاؤها بواسطة استدعاءين متتاليين لـ `tuist
generate` أو عبر البيئات أو عمليات التشغيل.

تأكد أيضًا من أن الهدف لا يعتمد بشكل مباشر أو غير مباشر على
<LocalizedLink href="/guides/features/cache/generated-project#supported-products">هدف
غير قابل للتخزين المؤقت</LocalizedLink>.

### الرموز المفقودة {#missing-symbols}

عند استخدام المصادر، يمكن لنظام البناء في Xcode، من خلال Derived Data، حل
التبعيات التي لم يتم الإعلان عنها صراحةً. ومع ذلك، عندما تعتمد على ذاكرة التخزين
المؤقت الثنائية، يجب الإعلان عن التبعيات صراحةً؛ وإلا فمن المحتمل أن تظهر أخطاء
في التجميع عندما يتعذر العثور على الرموز. لتصحيح هذا الخطأ، نوصي باستخدام الأمر
<LocalizedLink href="/guides/features/projects/inspect/implicit-dependencies">`tuist
inspect dependencies --only implicit`</LocalizedLink> وإعداده في CI لمنع التراجع
في الارتباط الضمني.

### ذاكرة التخزين المؤقتة للوحدة القديمة {#legacy-module-cache}

في Tuist `4.128.0` ، قمنا بجعل البنية التحتية الجديدة لذاكرة التخزين المؤقتة
للوحدة النمطية هي الإعداد الافتراضي. إذا واجهت مشكلات مع هذا الإصدار الجديد،
يمكنك الرجوع إلى سلوك ذاكرة التخزين المؤقتة القديمة عن طريق تعيين متغير البيئة
`TUIST_LEGACY_MODULE_CACHE`.

هذا النموذج القديم من ذاكرة التخزين المؤقت هو حل مؤقت وسيتم إزالته من جانب
الخادم في تحديث مستقبلي. خطط للتخلي عنه.

```bash
export TUIST_LEGACY_MODULE_CACHE=1
tuist generate
```
