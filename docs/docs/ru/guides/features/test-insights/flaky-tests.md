---
{
  "title": "Flaky Tests",
  "titleTemplate": ":title · Test Insights · Features · Guides · Tuist",
  "description": "Automatically detect and track flaky tests in your CI pipelines."
}
---
# Нестабильные тесты {#flaky-tests}

::: warning ТРЕБОВАНИЯ
<!-- -->
- <LocalizedLink href="/guides/features/test-insights">Необходимо настроить Test
  Insights</LocalizedLink>
<!-- -->
:::

Нестабильные тесты — это тесты, которые при многократном запуске с одним и тем
же кодом дают разные результаты (пройдены или провалены). Они подрывают доверие
к вашему набору тестов и заставляют разработчиков тратить время на расследование
ложных сбоев. Tuist автоматически обнаруживает нестабильные тесты и помогает
отслеживать их с течением времени.

![Страница «Нестабильные
тесты»](/images/guides/features/test-insights/flaky-tests-page.png)

## Как работает обнаружение нестабильности {#how-it-works}

Tuist обнаруживает нестабильные тесты двумя способами:

### Повторные попытки тестирования {#test-retries}

Когда вы запускаете тесты с помощью функции повторной попытки Xcode (с помощью
`-retry-tests-on-failure` или `-test-iterations`), Tuist анализирует результаты
каждой попытки. Если тест не проходит в некоторых попытках, но проходит в
других, он помечается как нестабильный.

Например, если тест не проходит при первой попытке, но проходит при повторной
попытке, Tuist записывает это как нестабильный тест.

```sh
tuist xcodebuild test \
  -scheme MyScheme \
  -retry-tests-on-failure \
  -test-iterations 3
```

![Детали нестабильного тестового
случая](/images/guides/features/test-insights/flaky-test-case-detail.png)

### Обнаружение перекрестных запусков {#cross-run-detection}

Даже без повторных попыток тестирования Tuist может обнаружить нестабильные
тесты, сравнивая результаты разных запусков CI для одного и того же коммита.
Если тест проходит в одном запуске CI, но проваливается в другом запуске для
того же коммита, оба запуска помечаются как нестабильные.

Это особенно полезно для выявления нестабильных тестов, которые не дают
достаточно стабильных сбоев, чтобы быть обнаруженными повторными попытками, но
все же вызывают периодические сбои CI.

## Управление нестабильными тестами {#managing-flaky-tests}

### Автоматическая очистка

Tuist автоматически снимает флаг «нестабильный» с тестов, которые не были
нестабильными в течение 14 дней. Это гарантирует, что исправленные тесты не
будут бесконечно оставаться помеченными как нестабильные.

### Ручное управление

Вы также можете вручную пометить или снять пометку о нестабильности тестов на
странице с подробной информацией о тестовом случае. Это полезно в следующих
случаях:
- Вы хотите отметить известный нестабильный тест во время работы над
  исправлением
- Тест был неправильно отмечен из-за проблем с инфраструктурой.

## Уведомления Slack {#slack-notifications}

Получайте мгновенные уведомления, когда тест становится нестабильным, настроив
<LocalizedLink href="/guides/integrations/slack#flaky-test-alerts">уведомления о
нестабильных тестах</LocalizedLink> в интеграции со Slack.
